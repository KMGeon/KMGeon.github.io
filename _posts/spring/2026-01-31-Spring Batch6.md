---
title: Spring Batch 6 
date: 2026-01-31
categories: [스프링]
tags: [스프링, 스프링배치]
author: mugeon
---

# 서론

---

오랜만에 글을 작성을 하면서 어떤 글을 작성할까 고민이 되었는데 최근에 Spring Batch 오픈소스 기여를 하면서 해당 내용에 대해서 글을 작성하면 좋을 거 같아서 
해당 내용에 대해서 글을 작성합니다.

가장 기본적으로 스프링 배치란 무엇일까? 정의에 대해서 설명을 하겠습니다.

저는 내부 백오피스 개발을 진행하면서 스프링 배치를 학습하고 사내에 도입한 경험이 있으면서 배치란 무엇일까? 고민을 하게 되었습니다.

다른 블로그에서는 스프링 배치에 대해서 설명할 때 다음과 같이 많이 설명을 합니다.

> 대용량 데이터를 처리하기 위한 프레임워크로, 스프링 프레임워크 기반에서 작동합니다. 일반적으로 배치 작업은 대량의 데이터를 처리하거나, 주기적이고 반복적인 작업을 실행하는 데 사용되며, 스프링 배치는 이러한 작업을 효율적이고 안정적으로 처리할 수 있는 대표적으로 아래와 같은 기능들을 제공합니다. 

제 생각도 비슷하지만 조금 생각이 다릅니다. **스프링 배치란 대용량 데이터를 처리하는 프레임워크로, 사람과 상호 작용 없이 이어지는 프로그램의 실행입니다.**

## API vs Batch: 핵심 차이점

가장 중요한 포인트는 **'사람과의 상호작용 유무'**라고 생각합니다. API로 만든 로직과 배치로 만든 로직을 비교해보겠습니다.

**API (웹 애플리케이션)**
- 사용자가 요청하고 응답을 기다립니다.
- 처리가 느려도 Loading 화면이나 다양한 UX 정책으로 대응할 수 있습니다.
- 사용자에게 진행 상황을 보여줄 수 있습니다.

**Batch (배치 작업)**
- 사람과 상호작용 없이 무인으로 실행됩니다.
- 일반적으로 특정 시간(스케줄)에 실행됩니다.
- **정해진 시간 내에 반드시 완료되어야 합니다.**
- UX로 지연을 보완할 수 없고, SLA(Service Level Agreement)를 준수해야 합니다.

## 실무 예시: 출고 배치

출고 도메인을 예시로 살펴보겠습니다. 1시간마다 배치를 실행하여 상품을 배송한다고 가정해봅시다.

**정상 케이스**
- 10건이든 10만건이든 모두 1시간 이내에 출고 작업이 완료되어야 합니다.

**문제 케이스**
- 10만건 처리 중 1차 배치에서 5만건만 출고되고 5만건이 pending 상태로 남았다고 가정합니다.
- 1시간 후 2차 배치가 실행되면 pending 상태인 5만건을 다시 조회하게 됩니다.
- 이때 중복 처리, 재고 오류, 이중 출고 등의 심각한 문제가 발생할 수 있습니다. 


# 본론

---

> 이제부터 우리는 물류 도메인 회사에 근무를 한다고 가정하고 모든 내용을 학습하겠습니다.

처음 배치를 학습할 때 이런 고민을 하게 됩니다. 배치는 대용량 작업을 수행할 때만 사용해야 하는가? 저 역시도 이러한 고민이 있었습니다.

대용량 작업도 아닌데 스프링 배치를 사용하면 오버 엔지니어링이라고 판단하지 않을까? 단순한 배치의 경우 Mybatis나 JdbcTemplate으로도 충분히 처리할 수 있기 때문입니다.

제 생각에는 오버엔지니어링 여부는 업무 환경과 팀의 숙련도에 따라 달라진다고 봅니다. 팀이 배치를 잘 다룬다면 굳이 API 기반으로 억지로 만들 필요가 없습니다.

그리고 대용량의 기준도 사실 모호합니다. 저 같은 경우는 300만건을 기준으로 작업을 수행했고 스프링 배치의 구조화된 방식 덕분에 관리가 쉬워서 적극적으로 활용했습니다.

만약 배치를 처음 도입한다면 대용량에 너무 신경쓰지 말고 스케줄링 관점에서 시작해도 괜찮다고 생각합니다.


## 사용 사례

### 1. 당일 출고 시스템

네이버 당일출고, 쿠팡 당일배송과 비슷한 맥락을 가지고 있습니다. 많은 B2C 채널에서 수집된 주문을 다양한 요구사항에 맞추어서 풀필먼트에 사용자에게 배달을 하도록 처리를 합니다.
이때 재고의 정합성, 외부 API의 이해 관계, 이중화된 출고 센터의 비즈니스를 포함하여 해결합니다. 

### 2. 데이터 마이그레이션 

시스템을 version2로 마이그레이션을 진행하면서 테이블 설계가 변경이 되며 그에 맞추어 데이터 ETL 작업 및 마이그레이션을 수행하였습니다. 해당 방식에서 배치를 진짜 잘 사용했다고 생각을 했던 상황이었습니다.
간단하게 설명하자면 저희는 1개의 DB에서 개발, 운영을 동시에 하면서 SQL Script로 마이그레이션을 하면 데드락, API기반으로 마이그레이션을 10시간이 넘는 시간이 걸렸습니다. 하지만 Batch를 이용해서 30분 이내에 모든 작업을 수행할 수 있었고 데이터 정합성 100%를 맞추었습니다.

### 3. 주문 수집

일반적으로 무신사, 카페24, 11번가 등 다양한 B2C 채널에 물건을 판매한다면 주문 수집을 위해서 이것을 통합하여 수집하는 B2B Sass가 있지만 쇼피파이, 유니브스토어, 퍼스트몰등 지원하지 않는 채널들이 존재합니다.
이때 데이터를 특정 시간에 수집하며 채널마다 다른 API의 규격을 사내 정책에 맞게 변경 및 가공하는데 사용합니다.


